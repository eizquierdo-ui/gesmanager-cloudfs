\nconst admin = require(\'firebase-admin\');\nconst { getFirestore } = require(\'firebase-admin/firestore\');\n\n// Inicializa el SDK de Firebase Admin.\ntry {\n  admin.initializeApp();\n} catch (e) {\n  if (!/already exists/.test(e.message)) {\n    console.error(\'Error al inicializar Firebase Admin SDK:\', e);\n    process.exit(1);\n  }\n}\n\nconst db = getFirestore();\n\n/**\n * Script para eliminar exclusivamente el campo \"icono\" de todos los documentos \n * en la colección `menu` donde este campo exista.\n */\nasync function deleteIconoField() {\n  console.log(\'Iniciando la operación para eliminar el campo \\\"icono\\\" de la colección \\\`menu\\\'...\');\n  const collectionRef = db.collection(\'menu\');\n  \n  try {\n    const snapshot = await collectionRef.get();\n    \n    if (snapshot.empty) {\n      console.log(\'Colección \\\'menu\\\' vacía. No se requiere ninguna acción.\');\n      return;\n    }\n\n    const batch = db.batch();\n    let documentsToUpdate = 0;\n\n    snapshot.forEach(doc => {\n      const data = doc.data();\n      // Si el campo \'icono\' existe en el documento, se añade la operación de borrado al batch.\n      if (data.icono !== undefined) {\n        const docRef = collectionRef.doc(doc.id);\n        batch.update(docRef, { icono: admin.firestore.FieldValue.delete() });\n        documentsToUpdate++;\n        console.log(`- Documento ${doc.id}: Campo \\\'icono\\\' marcado para eliminación.`);\n      }\n    });\n\n    if (documentsToUpdate > 0) {\n      await batch.commit();\n      console.log(`\\n¡Éxito! El campo \\\'icono\\\' fue eliminado de ${documentsToUpdate} documentos.`);\n    } else {\n      console.log(\'\\nNo se encontraron documentos que contengan el campo \\\'icono\\\'. La colección ya estaba limpia.\');\n    }\n\n  } catch (error) {\n    console.error(\'\\n¡ERROR CRÍTICO DURANTE LA OPERACIÓN! No se realizaron cambios.\', error);\n  }\n}\n\ndeleteIconoField();\n